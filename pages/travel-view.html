<!DOCTYPE html>
<html lang="en" class="travel-view-page">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
  <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
  <link rel="stylesheet" href="/css/travel-view.css" />
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/footer.css" />
  <link rel="stylesheet" href="/css/navbar.css" />
  <title>Travel View</title>
</head>
<body>
  <!-- Navbar Placeholder -->
  <div id="navbar-placeholder"></div>

  <div class="travel-view container">
    <div class="travel-content">
      <img src="" alt="" class="travel-image" id="travel-image">
      <div class="travel-info">
        <p><strong id="travel-title"></strong></p>
        <p class="location-info">
          <box-icon name="map" type="solid" color="#4CAF50"></box-icon> <span id="travel-location"></span>
        </p>
        <br>
        <p><strong>Description</strong></p>
        <p id="travel-description"></p>
      </div>
      <div class="travel-reviews" id="travel-reviews">
        <p><strong>Reviews (2)</strong></p>
        <div class="review-form">
          <p>Rate this tour: <span class="rating-stars" id="rating-stars">☆☆☆☆☆</span></p>
          <textarea placeholder="Share your feedback..." id="review-comment"></textarea>
          <button class="book-btn submit-review" style="float: right;">Submit</button>
        </div>
        <div class="review-item">
          <img src="/assets/hero/avatar.jpg" alt="User Icon" class="review-avatar">
          <div class="review-details">
            <p class="review-author">Thirosh <span class="review-rating">Rating: <span class="rating-stars">★★★★★</span></span></p>
            <p class="review-date">January 28, 2023</p>
            <p class="review-comment">Amazing Tour</p>
          </div>
        </div>
        <div class="review-item">
          <img src="/assets/hero/avatar.jpg" alt="User Icon" class="review-avatar">
          <div class="review-details">
            <p class="review-author">Thirosh <span class="review-rating">Rating: <span class="rating-stars">★★★★★</span></span></p>
            <p class="review-date">January 28, 2023</p>
            <p class="review-comment">Amazing Tour</p>
          </div>
        </div>
      </div>
    </div>
    <div class="travel-booking">
      <h3>Information</h3>
      <div class="form-group">
        <label>Location</label>
        <input type="text" placeholder="Arugam Bay" readonly id="booking-location">
      </div>
      <div class="form-group">
        <label>Guest Name</label>
        <input type="text" placeholder="Guest Full Name">
      </div>
      <div class="form-group">
        <label>WhatsApp Number</label>
        <input type="text" placeholder="WhatsApp Number">
      </div>
      <div class="form-group date-input">
        <label>Date</label>
        <input type="date" id="booking-date" name="booking-date">
      </div>
      <div class="form-group">
        <label>Guest Group Size</label>
        <input type="number" placeholder="Guest Group Size" value="1" min="1">
      </div>
      <div class="form-group">
        <label>Vehicle</label>
        <select id="vehicle-select">
          <option value="standard">Standard Car</option>
          <option value="suv">SUV</option>
          <option value="van">Van</option>
        </select>
      </div>
      <div class="price total">Total <span id="total-price"></span></div>
      <button class="book-btn"><box-icon name="whatsapp" type="logo" color="#fff"></box-icon> Book via WhatsApp</button>
    </div>
  </div>

  <!-- Footer Placeholder -->
  <div id="footer-placeholder"></div>

  <script type="text/javascript">
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
      return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
      if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
          var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
          var firstSheetName = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[firstSheetName];

          // Convert sheet to JSON to filter blank rows
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          // Filter out blank rows (rows where all cells are empty, null, or undefined)
          var filteredData = jsonData.filter(row => row.some(filledCell));

          // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
          var headerRowIndex = filteredData.findIndex((row, index) =>
            row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
          );
          // Fallback
          if (headerRowIndex === -1 || headerRowIndex > 25) {
            headerRowIndex = 0;
          }

          // Convert filtered JSON back to CSV
          var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
          csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
          return csv;
        } catch (e) {
          console.error(e);
          return "";
        }
      }
      return gk_fileData[filename] || "";
    }
  </script>

  <script src="/js/destination.js"></script> <!-- Include destination.js -->
  <script>
    // Function to load navbar and footer
    function loadComponent(id, file) {
      fetch(file)
        .then(response => {
          if (!response.ok) throw new Error(`Failed to fetch ${file}: ${response.statusText}`);
          return response.text();
        })
        .then(data => {
          document.getElementById(id).innerHTML = data;
          if (id === 'navbar-placeholder') {
            const menuBtn = document.getElementById("menu-btn");
            const navLinks = document.getElementById("nav-links");
            const menuBtnIcon = menuBtn.querySelector("i");
            menuBtn.addEventListener("click", () => {
              navLinks.classList.toggle("open");
              const isOpen = navLinks.classList.contains("open");
              menuBtnIcon.setAttribute("class", isOpen ? "ri-close-line" : "ri-menu-line");
            });
            navLinks.addEventListener("click", () => {
              navLinks.classList.remove("open");
              menuBtnIcon.setAttribute("class", "ri-menu-line");
            });
          }
        })
        .catch(error => console.error('Error loading component:', error));
    }

    // Load navbar and footer
    loadComponent('navbar-placeholder', '/components/navbar.html');
    loadComponent('footer-placeholder', '/components/footer.html');

    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const title = decodeURIComponent(urlParams.get('title'));

      const post = postsData.find(p => p.title === title);
      if (post) {
        document.getElementById('travel-image').src = post.img;
        document.getElementById('travel-title').textContent = post.title;
        document.getElementById('travel-location').textContent = post.location;
        document.getElementById('travel-description').textContent = post.description;
        document.getElementById('booking-location').value = post.location;
        document.getElementById('total-price').textContent = '$' + post.price;
      }

      // Set default date to today (09:42 AM +0530, October 06, 2025)
      const today = new Date('2025-10-06T09:42:00+0530').toISOString().split('T')[0];
      document.getElementById('booking-date').value = today;

      // Star rating interactivity
      const stars = document.getElementById('rating-stars');
      let rating = 0;
      stars.addEventListener('click', (e) => {
        const rect = stars.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const starWidth = rect.width / 5;
        rating = Math.ceil(clickX / starWidth);
        updateStars();
      });

      function updateStars() {
        stars.textContent = '☆☆☆☆☆'.slice(5 - rating) + '★★★★★'.slice(0, rating);
      }
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="/js/navbar-autohide.js"></script>
</body>
</html>